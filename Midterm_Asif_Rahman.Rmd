---
title: "Midterm - Asif Rahman"
author: "Asif Rahman"
date: "2023-March-10"
output:
  html_document: default
  pdf_document: default
---
```{r}
library(tidyverse)
library(readr)
library(seminr)
```

# **Upload The Dataset**
```{r}

# Separate columns based on comma

Midterm_data_Asif <- read_delim("D:/Study Abroad/For USA/Apply/Fall 2021/Chapter - 2/West Virginia University/Spring 2023/IENG 660 - Human Factors System Design/Mid Term/midterm_data.csv", delim = ",", escape_double = FALSE, trim_ws = TRUE)

View(Midterm_data_Asif)

# *Summary of the data*

summary(Midterm_data_Asif)

```
# **The Measurement Model**

```{r}
simple_mm_1 <-constructs(
  composite("XAI", multi_items("XAI", 1:8)),
  composite("CI", multi_items("CI", 1:3)),
  composite("EOU", multi_items("EOU", 1:6)),
  composite("BI", multi_items("BI", 1:5)),
  composite("PU", multi_items("PUF", 1:3))
)

```
# **Plot The Model**

```{r}

plot(simple_mm_1)

```

# **Specifying The Structural Model**

```{r}
simple_sm_1 <- relationships(
  paths(from = "XAI", to = c("BI", "EOU","PU")),
  paths(from = "BI", to = "CI")
)


```

# **Plot The Structural Model**

```{r}
plot(simple_sm_1)
```

# **Estimating the Model**

```{r}
simple_model <- estimate_pls(data=Midterm_data_Asif,
                             measurement_model = simple_mm_1,
                             structural_model = simple_sm_1,
                             inner_weights = path_weighting,
                             missing = mean_replacement,
                             missing_value = "-99")

```

```{r}
summary_simple<-summary(simple_model)

summary_simple

```
#Here the alpha, rhoC and rhoA value of CI did not exceed 0.7.And AVE value of XAI and CI did not exceed 0.5.

# To get more insight, all of them are plotted.

# **Plot the model**

```{r}

plot(simple_model)


```
# **Identify The Latent Construct of AVE**

```{r}
simple_model$outer_loadings

```
# It is found that the value of XAI2 and CI1 did not exceed 0.5. So, they will be eliminated and steps will be done again.


# ** New Data Load **

```{r}

# Separate columns based on comma

Midterm_data_Asif_New <- read_delim("D:/Study Abroad/For USA/Apply/Fall 2021/Chapter - 2/West Virginia University/Spring 2023/IENG 660 - Human Factors System Design/Mid Term/midterm_data_new.csv", delim = ",", escape_double = FALSE, trim_ws = TRUE)

View(Midterm_data_Asif_New)

# *Summary of the data*

summary(Midterm_data_Asif_New)

```


# **New Measurement Model**

```{r}
simple_mm_2 <-constructs(
  composite("XAI", multi_items("XAI", 1:1)),
  composite("XAI", multi_items("XAI", 3:8)),
  composite("CI", multi_items("CI", 2:3)),
  composite("EOU", multi_items("EOU", 1:6)),
  composite("BI", multi_items("BI", 1:5)),
  composite("PU", multi_items("PUF", 1:3))
)

```

# **Plot The New Model**

```{r}
plot(simple_mm_2)
```
# **Specifying The Structural Model**

```{r}
simple_sm_2 <- relationships(
  paths(from = "XAI", to = c("BI", "EOU","PU")),
  paths(from = "BI", to = "CI")
)


```

# **Plot The Structural Model**

```{r}
plot(simple_sm_2)
```

# **Estimating the Model**

```{r}
simple_model_2 <- estimate_pls(data=Midterm_data_Asif_New,
                             measurement_model = simple_mm_2,
                             structural_model = simple_sm_2,
                             inner_weights = path_weighting,
                             missing = mean_replacement,
                             missing_value = "-99")

```


```{r}
summary_simple_New <-summary(simple_model_2)

summary_simple_New

```
# It is found that all the values of XAI exceeded the minimum value of Alpha, rhoC, AVE and rhoA. For CI, minimum value of rhoC, AVE and rhoA was exceeded. But alpha value is still below 0.7. I have run the whole model again two times. No.1 - Kept CI3 , removed CI 2 and No.2 - kept CI2, removed CI3. For both of the cases I have found that all the alpha, rhoC , AVE and rhoA value turned into 1. This may also be a solution to this problem.

# But, as in the midterm it is mentioned that only AVE value is needed to be focused. So, I will keep both CI2 and CI3, as AVE value exceeded 0.5 and proceed with this model.


```{r}
simple_model_2$outer_loadings

```

```{r}

plot(simple_model_2)


```

# **Bootstrap the model**

```{r}
boot_simple <- bootstrap_model(seminr_model = simple_model_2,nboot = 10000,cores = NULL,seed = 123)
summary_boot <- summary(boot_simple, alpha = 0.05)
summary_boot
```
# Here we can see that all of the values are in positive side and do not include zero. That means all of them are significant.

# **Plot the bootstrapped model**

```{r}

plot(boot_simple,title = "Asif Rahman - Final Model")

```
# ** Now the significance of indirect effect needs to be checked. **

```{r}

summary_simple_New$total_indirect_effects


specific_effect_significance(boot_simple, from="XAI", through="BI", to="CI")

```
# From the result it is found that both the CI is in positive side. So, zero is not included. That means indirect path effect is significant.


# **Mediation analysis**



# For mediation analysis We need to create a loop.

# To check if XAI and CI is mediated by BI fully or pertially, 

# A direct path from XAI to CI is created.

```{r}
simple_sm_3 <- relationships(
  paths(from ="XAI",to = c("BI","EOU","PU","CI")),
  paths(from = "BI",to = "CI")
)
```


#Ploting the new path
```{r}

plot(simple_sm_3)

```

```{r}
simple_model_3 <- estimate_pls(data=Midterm_data_Asif_New,
                             measurement_model = simple_mm_2,
                             structural_model = simple_sm_3,
                             inner_weights = path_weighting,
                             missing = mean_replacement,
                             missing_value = "-99")

```

```{r}

plot(simple_model_3)

```
```{r}
boot_simple_2 <- bootstrap_model(seminr_model = simple_model_3,nboot = 10000,cores = NULL,seed = 123)

```

```{r}

summary_boot_2 <- summary(boot_simple_2, alpha = 0.05)
summary_boot_2

```

```{r}

plot(boot_simple_2,title = "Bootstrapped Model New")

```
# Checking the Confidence Interval

```{r}


specific_effect_significance(boot_simple_2, from="XAI",to="CI")

```
# Here 2.5% and 95% CI of XAI and CI does not include zero value.
# so, direct effect from XAI to CI is significant.
# Finally, both the indirect effect and direct effect is significant. 
# That means it is a partial Mediation.



# **Hypothesis Testing**

# For 3 Hypothesis testing H_1, H_2, H_3 , 3 new paths will be created.

# for H_1 = PU to BI , H_2 = EOU to PU and H_3 = BI to CI

```{r}
simple_sm_Asif <- relationships(
  paths(from = "XAI", to = c("BI", "EOU","PU")),
  paths(from ="PU",to = "BI"),
  paths(from ="EOU",to = "PU"),
  paths(from = "BI",to = "CI")
)
```


#Ploting the new path
```{r}

plot(simple_sm_Asif)

```
# For Hypothesis testing I am using modified data
```{r}

simple_model_Asif <- estimate_pls(data=Midterm_data_Asif_New,
                             measurement_model = simple_mm_2,
                             structural_model = simple_sm_Asif,
                             inner_weights = path_weighting,
                             missing = mean_replacement,
                             missing_value = "-99")

```

```{r}

plot(simple_model_Asif)

```




```{r}
boot_simple_Asif <- bootstrap_model(seminr_model = simple_model_Asif,nboot = 10000,cores = NULL,seed = 123)

```



```{r}

summary_boot_Asif <- summary(boot_simple_Asif, alpha = 0.05)
summary_boot_Asif

```


```{r}

plot(boot_simple_Asif,title = "Bootstrapped Model - Hypothesis Testing")

```

# ** Checking The Confidence Interval **

```{r}


specific_effect_significance(boot_simple_Asif, from="PU",to="BI")

```
#It does not include zero. It means it is significant. That means H1 hypothesis is accepdted.
```{r}


specific_effect_significance(boot_simple_Asif, from="EOU",to="PU")

```
#It does not include zero. It means it is significant. That means H2 hypothesis is accepdted.

```{r}


specific_effect_significance(boot_simple_Asif, from="BI",to="CI")

```
#It does not include zero. It means it is significant. That means H3 hypothesis is accepdted.




